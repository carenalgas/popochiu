---
weight: 7030
---

# Conventions

## Directory and file structure

### Repository's root folder

The project repository contains everything needed to develop, document, and release the plugin.  
As is standard for Godot addons, the actual code is located in the `addons` folder. Additional directories in the project root are used for documentation, automation, and a Godot project, which is automatically created in the `game` folder as soon as the plugin is enabled.

Below is the directory structure of the main [Popochiu repository](https://github.com/carenalgas/popochiu):  

```text
<Project Root>
├── .github                                 <-- Holds GitHub-related stuff, such as issue templates
|                                               and workflows actions.
|
├── addons
│   └── popochiu                            <-- The Popochiu Plugin and Engine reside here.
|                                               This is the part distributed in releases.
|
├── builds                                  <-- Used by release automation; should remain empty.
|
├── docs                                    <-- Contains the source for the documentation you are reading.
│   ├── dist                                <------ Used by release automation; you can ignore this.
│   ├── scripts                             <------ Holds scripts related to release automation.
│   └── src                                 <------ The main documentation source folder,
|       |                                           organized into subdirectories for each section.
│       ├── assets                          <---------- A special folder for public assets like
|       |                                                images, CSS files, and other resources.
|       └── < ... content folders ... >
├── game                                    <-- Automatically created when the plugin is enabled;
|                                               contains a functional Popochiu game. Not versioned.
└── release-notes                           <-- Contains text files with release notes, used during
                                                the release process.
```

In the root directory, you’ll also find the following notable files:

```text
home_banner.png  
icon.svg  
LEEME.md  
LICENSE  
popochiu.ico  
README.md  
```

These files are related to the project's README (available in Spanish as well) and general branding. Additionally, there’s the `project.godot` file, which is distributed with the plugin but generally should not be included in PRs unless under very specific circumstances.

You’ll also find the project’s `.gitignore` file. It’s fairly standard, excluding Godot-generated import files, common editor junk, and some files generated by release automations. It’s a good idea to review it and understand what’s excluded from the project before moving forward.

### Popochiu Addon folder

We won’t delve too deeply into the plugin's content here (refer to the [Project Overview](../project-overview) section for more details), but the `addons` folder is organized as follows:

```text
/addons/popochiu
|
├── editor                                  <-- Contains `@tool` scripts that extend Godot's editor
|   |                                           functionality, adding Popochiu docks, panels, gizmos, etc.
|   |
│   ├── canvas_editor_menu                  <------ Logic for adding buttons to the scene toolbar.
│   ├── config                              <------ Logic and defaults for project and editor settings.
│   ├── factories                           <------ Factory classes for creating Popochiu objects
|   |                                               (rooms, characters, dialogues, props, etc.).
│   ├── gizmos                              <------ Custom gizmos for Popochiu objects, used in scene
|   |                                               preview to interactively set their properties.
│   ├── helpers                             <------ Classes with commonly used static methods.
│   ├── importers                           <------ Asset importers for various formats.
│   ├── inspector                           <------ Extensions and customizations for the inspectors of
|   |                                               Popochiu objects.
│   ├── main_dock                           <------ Implementation of Popochiu's main dock (entry point
|   |                                               for all game elements).
│   └── popups                              <------ Editor popups for tasks like running migrations,
|                                                   object creation, progress bars, project setup, etc.
|
|
├── engine                                  <-- Contains the game engine — the core that actually runs your game.
|   |                                           Subfolder names are mostly self-explanatory and represent
|   |                                           various engine subsystems (see "Project Overview" section).
│   ├── audio_manager
│   ├── cursor
│   │   └── sprites
│   ├── helpers                             <------ Contains helper functions useful in both game scripts
|   |                                               and core engine code.
|   |
│   ├── interfaces                          <------ Provides code for Singleton accessors (A, C, E, etc.).
|   |
│   ├── objects
│   │   ├── character
│   │   ├── clickable
│   │   ├── dialog
│   │   ├── gui
│   │   ├── hotspot
│   │   ├── inventory_item
│   │   ├── prop
│   │   ├── region
│   │   ├── room
│   │   ├── transition_layer
│   │   └── walkable_area
│   ├── others                              <------ Contains miscellaneous engine logic.
│   └── templates                           <------ Game UI templates (e.g., 9-Verbs, SimpleClick, Icon-Bar).
│       └── gui
├── icons
├── migration                               <------ Handles the logic for upgrading users' projects to new
|   |                                               Popochiu versions as they are released.
│   ├── helpers
│   ├── migration
│   └── migrations
└── palette
```

If your contribution adds new elements to the engine or plugin, please ensure they are placed in their appropriate locations.

## Coding standards

### GDScript code

Popochiu adheres to the [official GDScript style guide](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html) for both code and [file and folder naming conventions](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html).

To ensure your code complies with these guidelines, you can use the [GDScript Toolkit](https://github.com/Scony/godot-gdscript-toolkit) by [Pawel Lampe](https://github.com/Scony).

As of now, no automatic linting is available as a pre-commit hook or during PR submission. Please verify that your code is compliant before submitting your PRs.

### Python code

Some scripts and automation, mostly related to the documentation, are written in Python.  
We’re quite permissive when it comes to Python code, as it’s only used for secondary scripts and automation tasks, and the amount of code involved is minimal. However, when in doubt, it’s always a good idea to adhere to the [PEP 8 style guide](https://peps.python.org/pep-0008/), which is the widely accepted standard for Python code.

To ensure your code aligns with PEP 8, you can rely on one of the many available linters such as **[Black](https://black.readthedocs.io/en/stable/)**, **[Flake8](https://flake8.pycqa.org/en/latest/)** or **[Pylint](https://pylint.pycqa.org/en/latest/)** - or any other one you prefer.

### Markdown Code

The Popochiu documentation is entirely written in Markdown, with several syntax extensions to support advanced functionality such as Mermaid diagrams, code highlighting, admonition blocks, definition lists, and more. These extensions are provided as Python modules included in the documentation Docker image.

For Markdown files, we adhere to [GitHub's Markdown style guide](https://github.com/style-guides/Markdown).

If you are using Visual Studio Code, we recommend installing the following extensions to ensure your Markdown code is properly reviewed during editing:

- [markdownlint](https://marketplace.visualstudio.com/items?itemName=DavidAnson.vscode-markdownlint): Linting for Markdown files to ensure adherence to standards.
- [Markdown All in One](https://marketplace.visualstudio.com/items?itemName=yzhang.markdown-all-in-one): Provides shortcuts, table of contents generation, and other helpful features for Markdown editing.
- [Mermaid Markdown Syntax Highlighting](https://marketplace.visualstudio.com/items?itemName=bpruitt-goddard.mermaid-markdown-syntax-highlighting): Adds syntax highlighting support for Mermaid diagrams in Markdown files.

## Code comments

Commenting the code, whether it’s part of the plugin or the engine, is strongly encouraged. Detailed, multi-line comments that explain the reasoning behind a function’s implementation are highly appreciated, as they enhance maintainability and readability for future contributors. Comments not only help maintainers understand your code but also make it easier for other contributors to navigate the codebase.

**Good**:

```{.gdscript .code-example-good}
    # If the path is not empty it has at least two points: the start and the end
    # so we can safely say index 1 is available.
    # The character should face the direction of the next point in the path, then...
    character.face_direction(moving_character_data.path[1])
    # ... we remove the first point of the path since it is the character's current position.
    moving_character_data.path.remove_at(0)
```

**Bad**:

```{.gdscript .code-example-bad}
    # Face the character to the next point in path
    character.face_direction(moving_character_data.path[1])
    moving_character_data.path.remove_at(0)
```

Comments should focus on explaining why the code is written a certain way, rather than what it does (which should already be clear from the code itself). Including references to specific issues in the format `#<issue_number>~` is valid and encouraged, as it provides helpful context to readers.

**Good**:

```{.gdscript .code-example-good}
    # Fixes #322 (Hidden Character are still visible in a room after hiding it).
    # This was expected to be done in function ... but we're doing it here because ...
    Character.visible = false
```

**Bad**:

```{.gdscript .code-example-bad}
    # Fixes a bug that makes a hidden character still visible in a room.
    Character.visible = false
```

All comments, even single-line ones, should start with a capital letter and end with a period. Whenever possible, use single-line comments placed above the relevant code rather than at the end of a line, as this improves clarity and readability.

**Good**:

```{.gdscript .code-example-good}
    # The character is now visible.
    Character.visible = false
```

**Bad**:

```{.gdscript .code-example-bad}
    # the character is now visible
    Character.visible = false
```

### Naming conventions

In addition to the formatting rules outlined in the [GDScript Style Guide](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html), Popochiu defines a small set of specific naming conventions.

#### Classes

All engine and plugin class names **must** begin with `Popochiu`. This compensates for the lack of namespacing in the GDScript language. This rule may (and likely will) change in the future if GDScript introduces proper namespace support.

**Good**:

```{.gdscript .code-example-good}
class PopochiuSuperMagicStuff
```

**Bad**:

```{.gdscript .code-example-bad}
class SuperMagicStuff
```

All classes must be explicitly named. The only exception is for scripts used solely for inheritance and never instantiated by the end user (see `factory_based_popochiu_obj.gd` as an example). However, naming these scripts is still encouraged to enforce strong typing.

#### Functions and Variables

The primary rule for functions and variables is to use names that are both explicit **and** relevant. Don't be stingy; keystrokes are free!

**Good**:

```{.gdscript .code-example-good}
func move_handler():
    # ...
var handler_to_move
```

**Bad** (implicit, cryptic):

```{.gdscript .code-example-bad}
func mh():
    # ...
var htm
```

**Also bad** (irrelevant, non-descriptive):

```{.gdscript .code-example-bad}
func doStuff():
    # ...
var myHandler
```

When naming public members that refer to an instance of their class, try to make them read natural when invoked by the client code:

**Good**:

```{.gdscript .code-example-good}
class PopochiuCharacter:
    # ...
    func move_to(target_pos: Vector2) -> void:
        # ...

# In client code
Hero.move_to(_last_clicked.position)
```

**Bad**:

```{.gdscript .code-example-bad}
class PopochiuCharacter:
    # ...
    func move_character(target_pos: Vector2) -> void:
        # ...

# In client code (note how this reads poorly)
Hero.move_character(_last_clicked.position)
```

#### Script names

There is no strict rule for script naming. The only best practice we enforce is to name scripts after the class they contain, following Godot's `snake_case` convention. Historically, Popochiu code has mixed file names that start with `popochiu` and those that do not, even if the contained class starts with `Popochiu`.

This redundancy can be safely omitted, and maybe in the future we'll settle on a specific format for that. In the meantime, you are free to name your scripts in the way that feels most clear to you.

**Good**:

```{.text .code-example-good}
cursor.gd -> contains PopochiuCursor class
```

**Also good**:

```{.text .code-example-good}
popochiu_cursor.gd -> contains PopochiuCursor class
```

**Bad**:

```{.gdscript .code-example-bad}
crsr.gd -> not named after the PopochiuCursor class it contains
PopochiuCursor.gd -> does not follow Godot's file naming conventions
```

!!! note
    File naming guidelines for documentation and assets can be found in the [Contributing documentation](TBD) section.

### Code documentation comments

When adding a **public** or **virtual** method to any of the Engine classes, it is **mandatory** to include documentation comments following the [GDScript documentation comments format](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_documentation_comments.html#gdscript-documentation-comments). These comments ensure that the method is properly documented for both inline consumption within Godot and the code reference exported to the documentation website.

Remember, [you can use _BBCode_ formatting and reference other code elements](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_documentation_comments.html#bbcode-and-class-reference).

The preferred format for public methods is as follows:

#### Classes and inner classes

```gdcript
## A brief description of the class's role and functionality.
##
## The description of the script / class, its purpose, what
## it can do, and any further detail.
##
## @tutorial:             https://example.com/tutorial_1
## @experimental
## @deprecated
```

The `@tutorial`, `@experimental`, and `@deprecated` tags are optional. They can all contain descriptions, such as:

```gdscript
## @deprecated: Use [Class OtherClass] instead.
```

#### Fuctions and methods

```gdcript
## A brief description of the function, its purpose, what it
## does, and how it relates with other functions (if relevant).
##
## Explain function arguments and return value.
##
## Usage:
## [codeblock]
## ...
##     # Do this in that context
##     my_var = my_function(param, other_param)
##     my_var.some_method()
## ...
## [/codeblock]
```

The `Usage` section is optional but **strongly encouraged** for all non-trivial functions. Including it significantly improves the quality and clarity of Popochiu's public API.

#### Enums, Enum values, Signals, Constants and Variables

The preferred format for all these elements is:

```gdscript
## Purpose of the constant
## ... uses that constant to ...
const MY_CONSTANT = "Value"

## Purpose, context and scope of the enum
enum MyEnum {
    ## Meaning of this value
    VALUE_1,
    ## Meaning of this value
    VALUE_2,
    ## Meaning of this value
    VALUE_3,
}

## Emitted when ...
## Arguments contain ...
## ... connects to this signal in order to ....
signal my_signal(arg1: Type, arg2: Type)

## Holds ...
## Defaults to ... (value and meaning)
## Set this to ... for ... and to ... for ...
@export var my_public_var: Type = Class.VALUE
```

Although Godot allows end-of-line comments for these elements, Popochiu adheres to the "above the line" format:

**Good**:

```{.gdscript .code-example-good}
## Documentation comment
var my_public_var: Type
```

**Bad**:

```{.gdscript .code-example-bad}
var my_public_var: Type ## Documentation comment
```

For private methods or classes within the Plugin, writing proper comments in the aforementioned format is encouraged but not required. In these cases, however, **comments should not start with the double hash** (`##`). This distinction is crucial, as only public methods relevant to game developers using Popochiu should appear in the exported code reference. This ensures that the documentation focuses exclusively on scripting functions that assist developers in creating their projects.

```{.gdscript .code-example-good}
# A brief description of this private function, its purpose, what
# it does, and how it relates with other functions (if relevant).
#
# Explain function arguments and return value.
func _my_private_function(arg1: Type) -> Type:
    # ...
```

**Bad**:

```{.gdscript .code-example-bad}
## A brief description of this private function, its purpose, what
## it does, and how it relates with other functions (if relevant).
##
## Explain function arguments and return value.
func _my_private_function(arg1: Type) -> Type:
    # ...
```

Writing private code documentation using the same structure as public documentation but with single-hash comments (`#`) helps explain to other contributors how to use functions within the plugin space effectively.

### Admonitions

You can use `TODO:`, `FIXME:`, `IMPROVE:`, or `NOTE:` annotations in your comments when needed. Here's a quick guide to when each should be used:

| **Admonition** | **When to use it** |
| --- | --- |
| `TODO` | Use this when you know some out-of-scope work needs to be done. It's especially helpful if you also include a brief explanation or reasoning to guide future development. |
| `FIXME` | Use this when committing code with known issues or temporary fixes. **Only allowed in draft PRs.** |
| `IMPROVE` | Use this when you recognize that your code could be improved but don't yet know how, or when you know how to improve it but it’s out of scope for the current implementation. |
| `NOTE` | Use this to leave important information for yourself or other contributors. It's ideal for clarifying false code smells, explaining impacts or reasoning behind the code, or highlighting any other critical details that **should** be understood before touching the code. |

## Error handling

We have no conventions for the error handling yet. This section is therefore maked as:

TODO

## Workflow

### Branching model and naming

The project maintainers follow a branching model inspired by [git-flow](https://www.gitkraken.com/learn/git/git-flow).

The following key branches are vital to the project's workflow:

- **`main`**: Used for releases. Work done on `develop` is merged into `main` and tagged with a version number in the `vX.Y.Z` format.
- **`develop`**: The integration branch (even though no automated tests are currently available). All work should be branched off from and merged back into this branch.
- **`release/<version>`**: These branches are no longer in use and remain for historical reference. Currently, only the 2.0 major version is supported, with a "roll-forward" strategy applied to address any issues in new releases.
- **`gh-pages`**: Contains the documentation you are reading now. This branch is managed by the release automation system and should never be modified manually.

Maintainers work directly on the main repository by branching from `develop` using the following naming conventions:

- **`feature/<issue_number>-easy-to-read-name`**: For developing new features, improvements, or planned work.
- **`fix/<issue_number>-easy-to-read-name`**: For bug fixes, whether urgent or not.
- **`docs/<issue_number>-easy-to-read-name`**: For documentation updates, when done in isolation (documentation for new functions must accompany the related code in the same PR).

Including the issue number in the branch name makes it easy to trace the branch back to its context.

### Contributor Workflow

Contributors working on their own forks are not required to follow this branching model. They can choose to:

- Commit directly to their `develop` branch and open a PR targeting our `develop` branch.
- Create a branch using their preferred naming convention and open a PR targeting our `develop` branch.

While following the same naming conventions is not mandatory, it is encouraged to maintain a clean and organized repository.

### Commit format

Commit messages **must** follow this format:

`refs #<issue_number>: Clear commit message, explaning why - not what.`

This format allows seamless navigation between commits and issues in the GitHub interface. While GitHub supports other keywords besides refs, we stick to it consistently to avoid confusion or misinterpretation.

Commit messages must:

* Start with a capital letter and end with a full stop.
* Provide informative content explaining why the change was made, not what (since the "what" is visible in the code).

**Good**:

```{.text .code-example-good}
refs #123: Made the function to flip the character's sprite public.
```

**Very Good**:

```{.text .code-example-good}
refs #123: Function to flip the character is now public to simulate the "Confused John Travolta" meme.
```

**Bad**:

```{.text .code-example-bad}
refs #123: changes to the character flip function
```

### Pull Requests

Pull requests titles must follow [the same format as commit messages](#commit-format).

For large PRs with extensive changes, please use the description field to provide an overview, helping reviewers understand the context and purpose of your work.

!!! warning "Important"
    Always [check the "Allow edits by maintainers" flag](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/allowing-changes-to-a-pull-request-branch-created-from-a-fork#enabling-repository-maintainer-permissions-on-existing-pull-requests) when opening a PR. This option allows maintainers to pull and push changes directly to your PR branch on your fork. It makes collaboration smoother, especially for complex or extensive changes.

## Testing

Popochiu currently lacks automated test coverage, so no conventions have been established yet. This section will be updated as soon as testing practices are introduced.

## Dependencies

Godot does not yet have a mature dependency manager to handle composition and interdependencies between addons. As a result, our approach for Popochiu is to implement every feature as an internal feature.

A good example is the Aseprite Importer, which was inspired by (and partially based on) the excellent [Godot Aseprite Wizard](https://github.com/viniciusgerevini/godot-aseprite-wizard) by [Vinicius Gerevini](https://github.com/viniciusgerevini). However, the feature was rewritten and fully integrated into Popochiu to simplify distribution and avoid external dependencies.

For this reason, contributions that rely on third-party addons will not be accepted.
